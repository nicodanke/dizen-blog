{"ast":null,"code":"import { useContext, useCallback, useMemo, useEffect, useRef, useState } from 'react';\nimport { useSyncExternalStore } from 'use-sync-external-store/shim';\nimport { getI18n, getDefaults, ReportNamespaces, I18nContext } from './context.js';\nimport { warnOnce, loadNamespaces, loadLanguages, hasLoadedNamespace, isString, isObject } from './utils.js';\n\nconst notReadyT = (k, optsOrDefaultValue) => {\n  if (isString(optsOrDefaultValue)) return optsOrDefaultValue;\n  if (isObject(optsOrDefaultValue) && isString(optsOrDefaultValue.defaultValue)) return optsOrDefaultValue.defaultValue;\n  return Array.isArray(k) ? k[k.length - 1] : k;\n};\n\nconst notReadySnapshot = {\n  t: notReadyT,\n  ready: false\n};\n\nconst dummySubscribe = () => () => {};\n\nexport const useTranslation = (ns, props = {}) => {\n  const {\n    i18n: i18nFromProps\n  } = props;\n  const {\n    i18n: i18nFromContext,\n    defaultNS: defaultNSFromContext\n  } = useContext(I18nContext) || {};\n  const i18n = i18nFromProps || i18nFromContext || getI18n();\n  if (i18n && !i18n.reportNamespaces) i18n.reportNamespaces = new ReportNamespaces();\n\n  if (!i18n) {\n    warnOnce(i18n, 'NO_I18NEXT_INSTANCE', 'useTranslation: You will need to pass in an i18next instance by using initReactI18next');\n  }\n\n  const i18nOptions = useMemo(() => ({ ...getDefaults(),\n    ...i18n?.options?.react,\n    ...props\n  }), [i18n, props]);\n  const {\n    useSuspense,\n    keyPrefix\n  } = i18nOptions;\n  const namespaces = useMemo(() => {\n    const nsOrContext = ns || defaultNSFromContext || i18n?.options?.defaultNS;\n    return isString(nsOrContext) ? [nsOrContext] : nsOrContext || ['translation'];\n  }, [ns, defaultNSFromContext, i18n]);\n  i18n?.reportNamespaces?.addUsedNamespaces?.(namespaces);\n  const revisionRef = useRef(0);\n  const subscribe = useCallback(callback => {\n    if (!i18n) return dummySubscribe;\n    const {\n      bindI18n,\n      bindI18nStore\n    } = i18nOptions;\n\n    const wrappedCallback = () => {\n      revisionRef.current += 1;\n      callback();\n    };\n\n    if (bindI18n) i18n.on(bindI18n, wrappedCallback);\n    if (bindI18nStore) i18n.store.on(bindI18nStore, wrappedCallback);\n    return () => {\n      if (bindI18n) bindI18n.split(' ').forEach(e => i18n.off(e, wrappedCallback));\n      if (bindI18nStore) bindI18nStore.split(' ').forEach(e => i18n.store.off(e, wrappedCallback));\n    };\n  }, [i18n, i18nOptions]);\n  const snapshotRef = useRef();\n  const getSnapshot = useCallback(() => {\n    if (!i18n) {\n      return notReadySnapshot;\n    }\n\n    const calculatedReady = !!(i18n.isInitialized || i18n.initializedStoreOnce) && namespaces.every(n => hasLoadedNamespace(n, i18n, i18nOptions));\n    const currentLng = props.lng || i18n.language;\n    const currentRevision = revisionRef.current;\n    const lastSnapshot = snapshotRef.current;\n\n    if (lastSnapshot && lastSnapshot.ready === calculatedReady && lastSnapshot.lng === currentLng && lastSnapshot.keyPrefix === keyPrefix && lastSnapshot.revision === currentRevision) {\n      return lastSnapshot;\n    }\n\n    const calculatedT = i18n.getFixedT(currentLng, i18nOptions.nsMode === 'fallback' ? namespaces : namespaces[0], keyPrefix);\n    const newSnapshot = {\n      t: calculatedT,\n      ready: calculatedReady,\n      lng: currentLng,\n      keyPrefix,\n      revision: currentRevision\n    };\n    snapshotRef.current = newSnapshot;\n    return newSnapshot;\n  }, [i18n, namespaces, keyPrefix, i18nOptions, props.lng]);\n  const [loadCount, setLoadCount] = useState(0);\n  const {\n    t,\n    ready\n  } = useSyncExternalStore(subscribe, getSnapshot, getSnapshot);\n  useEffect(() => {\n    if (i18n && !ready && !useSuspense) {\n      const onLoaded = () => setLoadCount(c => c + 1);\n\n      if (props.lng) {\n        loadLanguages(i18n, props.lng, namespaces, onLoaded);\n      } else {\n        loadNamespaces(i18n, namespaces, onLoaded);\n      }\n    }\n  }, [i18n, props.lng, namespaces, ready, useSuspense, loadCount]);\n  const finalI18n = i18n || {};\n  const ret = useMemo(() => {\n    const arr = [t, finalI18n, ready];\n    arr.t = t;\n    arr.i18n = finalI18n;\n    arr.ready = ready;\n    return arr;\n  }, [t, finalI18n, ready]);\n\n  if (i18n && useSuspense && !ready) {\n    throw new Promise(resolve => {\n      const onLoaded = () => resolve();\n\n      if (props.lng) {\n        loadLanguages(i18n, props.lng, namespaces, onLoaded);\n      } else {\n        loadNamespaces(i18n, namespaces, onLoaded);\n      }\n    });\n  }\n\n  return ret;\n};","map":{"version":3,"sources":["/Users/nicodanke/development/dizen/react-blog-template/node_modules/react-i18next/dist/es/useTranslation.js"],"names":["useContext","useCallback","useMemo","useEffect","useRef","useState","useSyncExternalStore","getI18n","getDefaults","ReportNamespaces","I18nContext","warnOnce","loadNamespaces","loadLanguages","hasLoadedNamespace","isString","isObject","notReadyT","k","optsOrDefaultValue","defaultValue","Array","isArray","length","notReadySnapshot","t","ready","dummySubscribe","useTranslation","ns","props","i18n","i18nFromProps","i18nFromContext","defaultNS","defaultNSFromContext","reportNamespaces","i18nOptions","options","react","useSuspense","keyPrefix","namespaces","nsOrContext","addUsedNamespaces","revisionRef","subscribe","callback","bindI18n","bindI18nStore","wrappedCallback","current","on","store","split","forEach","e","off","snapshotRef","getSnapshot","calculatedReady","isInitialized","initializedStoreOnce","every","n","currentLng","lng","language","currentRevision","lastSnapshot","revision","calculatedT","getFixedT","nsMode","newSnapshot","loadCount","setLoadCount","onLoaded","c","finalI18n","ret","arr","Promise","resolve"],"mappings":"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","sourcesContent":["import { useContext, useCallback, useMemo, useEffect, useRef, useState } from 'react';\nimport { useSyncExternalStore } from 'use-sync-external-store/shim';\nimport { getI18n, getDefaults, ReportNamespaces, I18nContext } from './context.js';\nimport { warnOnce, loadNamespaces, loadLanguages, hasLoadedNamespace, isString, isObject } from './utils.js';\nconst notReadyT = (k, optsOrDefaultValue) => {\n  if (isString(optsOrDefaultValue)) return optsOrDefaultValue;\n  if (isObject(optsOrDefaultValue) && isString(optsOrDefaultValue.defaultValue)) return optsOrDefaultValue.defaultValue;\n  return Array.isArray(k) ? k[k.length - 1] : k;\n};\nconst notReadySnapshot = {\n  t: notReadyT,\n  ready: false\n};\nconst dummySubscribe = () => () => {};\nexport const useTranslation = (ns, props = {}) => {\n  const {\n    i18n: i18nFromProps\n  } = props;\n  const {\n    i18n: i18nFromContext,\n    defaultNS: defaultNSFromContext\n  } = useContext(I18nContext) || {};\n  const i18n = i18nFromProps || i18nFromContext || getI18n();\n  if (i18n && !i18n.reportNamespaces) i18n.reportNamespaces = new ReportNamespaces();\n  if (!i18n) {\n    warnOnce(i18n, 'NO_I18NEXT_INSTANCE', 'useTranslation: You will need to pass in an i18next instance by using initReactI18next');\n  }\n  const i18nOptions = useMemo(() => ({\n    ...getDefaults(),\n    ...i18n?.options?.react,\n    ...props\n  }), [i18n, props]);\n  const {\n    useSuspense,\n    keyPrefix\n  } = i18nOptions;\n  const namespaces = useMemo(() => {\n    const nsOrContext = ns || defaultNSFromContext || i18n?.options?.defaultNS;\n    return isString(nsOrContext) ? [nsOrContext] : nsOrContext || ['translation'];\n  }, [ns, defaultNSFromContext, i18n]);\n  i18n?.reportNamespaces?.addUsedNamespaces?.(namespaces);\n  const revisionRef = useRef(0);\n  const subscribe = useCallback(callback => {\n    if (!i18n) return dummySubscribe;\n    const {\n      bindI18n,\n      bindI18nStore\n    } = i18nOptions;\n    const wrappedCallback = () => {\n      revisionRef.current += 1;\n      callback();\n    };\n    if (bindI18n) i18n.on(bindI18n, wrappedCallback);\n    if (bindI18nStore) i18n.store.on(bindI18nStore, wrappedCallback);\n    return () => {\n      if (bindI18n) bindI18n.split(' ').forEach(e => i18n.off(e, wrappedCallback));\n      if (bindI18nStore) bindI18nStore.split(' ').forEach(e => i18n.store.off(e, wrappedCallback));\n    };\n  }, [i18n, i18nOptions]);\n  const snapshotRef = useRef();\n  const getSnapshot = useCallback(() => {\n    if (!i18n) {\n      return notReadySnapshot;\n    }\n    const calculatedReady = !!(i18n.isInitialized || i18n.initializedStoreOnce) && namespaces.every(n => hasLoadedNamespace(n, i18n, i18nOptions));\n    const currentLng = props.lng || i18n.language;\n    const currentRevision = revisionRef.current;\n    const lastSnapshot = snapshotRef.current;\n    if (lastSnapshot && lastSnapshot.ready === calculatedReady && lastSnapshot.lng === currentLng && lastSnapshot.keyPrefix === keyPrefix && lastSnapshot.revision === currentRevision) {\n      return lastSnapshot;\n    }\n    const calculatedT = i18n.getFixedT(currentLng, i18nOptions.nsMode === 'fallback' ? namespaces : namespaces[0], keyPrefix);\n    const newSnapshot = {\n      t: calculatedT,\n      ready: calculatedReady,\n      lng: currentLng,\n      keyPrefix,\n      revision: currentRevision\n    };\n    snapshotRef.current = newSnapshot;\n    return newSnapshot;\n  }, [i18n, namespaces, keyPrefix, i18nOptions, props.lng]);\n  const [loadCount, setLoadCount] = useState(0);\n  const {\n    t,\n    ready\n  } = useSyncExternalStore(subscribe, getSnapshot, getSnapshot);\n  useEffect(() => {\n    if (i18n && !ready && !useSuspense) {\n      const onLoaded = () => setLoadCount(c => c + 1);\n      if (props.lng) {\n        loadLanguages(i18n, props.lng, namespaces, onLoaded);\n      } else {\n        loadNamespaces(i18n, namespaces, onLoaded);\n      }\n    }\n  }, [i18n, props.lng, namespaces, ready, useSuspense, loadCount]);\n  const finalI18n = i18n || {};\n  const ret = useMemo(() => {\n    const arr = [t, finalI18n, ready];\n    arr.t = t;\n    arr.i18n = finalI18n;\n    arr.ready = ready;\n    return arr;\n  }, [t, finalI18n, ready]);\n  if (i18n && useSuspense && !ready) {\n    throw new Promise(resolve => {\n      const onLoaded = () => resolve();\n      if (props.lng) {\n        loadLanguages(i18n, props.lng, namespaces, onLoaded);\n      } else {\n        loadNamespaces(i18n, namespaces, onLoaded);\n      }\n    });\n  }\n  return ret;\n};"]},"metadata":{},"sourceType":"module"}